{% extends 'layouts/base.html' %}

{% block back_link %}
    <a href="{% url 'applications:applications' %}" id="back-link" class="govuk-back-link">Back</a>
{% endblock %}

{% block body %}
    <div class="lite-app-bar">
        <div class="lite-app-bar__content">
            <h1 class="govuk-heading-l">{{ title }}</h1>
        </div>
        <div class="lite-app-bar__controls">
			{% if application.status.value|lower not in read_only_statuses and application.application_type.key != 'hmrc_query' %}
				<a href="{% url 'applications:withdraw' application.id %}" id="button-withdraw-application" class="govuk-button govuk-button--secondary">
					{% lcs 'APPLICATION_WITHDRAW_ACCESS_BUTTON' %}
				</a>
				<a href="{% url 'applications:edit_type' application.id %}" id='edit-application-button' class="govuk-button">
					{% lcs 'APPLICATION_EDIT_APPLICATION_BUTTON' %}
				</a>
			{% endif %}
        </div>
    </div>

    <div class="lite-information-board">
        <div class="govuk-grid-row">
            <div class="govuk-grid-column-one-third">
                <p class="lite-heading-s">{% lcs 'APPLICATION_TYPE' %}</p>
                <p class="govuk-label">{{ application.application_type.value }}</p>
            </div>
			{% if application.application_type.key != 'hmrc_query' %}
	            <div class="govuk-grid-column-one-third">
	                <p class="lite-heading-s">{% lcs 'APPLICATION_EXPORT_TYPE' %}</p>
	                <p class="govuk-label">
	                    {{ application.export_type.value }}
	                </p>
	            </div>
			{% endif %}
			<div class="govuk-grid-column-one-quarter">
				<p class="lite-heading-s">{% lcs 'APPLICATION_STATUS' %}</p>
				<p class="govuk-label" id="label-application-status">
					{{ application.status.value }}
				</p>
			</div>
            <div class="govuk-grid-column-one-third">
                <p class="lite-heading-s">{% lcs 'APPLICATION_SUBMITTED_AT' %}</p>
                <p class="govuk-label">
                    {{ application.last_modified_at|str_date }}
                </p>
            </div>
        </div>
    </div>

	{% if application.application_type.key != 'hmrc_query' %}
	    <div class="lite-tabs--fade">
	        <div class="lite-tabs">
	            <a href="{% url 'applications:detail' application.id 'case-notes' %}"
	               class="lite-tabs__tab {% if type == 'case-notes' %}lite-tabs__tab--selected{% endif %}"
	               id="case-notes-tab">
	                Notes
	                {% if case_note_notifications %}
	                    <div class="lite-notification-bubble">
	                        {{ case_note_notifications }}
	                    </div>
	                {% endif %}
	            </a>
	            <a href="{% url 'applications:detail' application.id 'ecju-queries' %}"
	               class="lite-tabs__tab {% if type == 'ecju-queries' %}lite-tabs__tab--selected{% endif %}"
	               id="ecju-queries-tab">
	                ECJU Queries
	                {% if ecju_query_notifications %}
	                    <div class="lite-notification-bubble">
	                        {{ ecju_query_notifications }}
	                    </div>
	                {% endif %}
	            </a>
	        </div>
	    </div>
	    {% if type == 'case-notes' %}
	        {% include "applications/tabs/case-notes.html" %}
	    {% elif type == 'ecju-queries' %}
	        {% include "applications/tabs/ecju-queries.html" %}
	    {% endif %}
	{% endif %}

{% endblock %}
