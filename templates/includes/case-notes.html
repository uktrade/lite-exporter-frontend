{% load static %}

{% if post_url %}
	<form method="post" action="{{ post_url }}">
		{% csrf_token %}
		{% if not status_is_terminal %}
			<label class="govuk-label" for="input-case-note">Add a note</label>
			<div class="lite-case-note__container">
				<textarea id="input-case-note" name="text" cols="80" class="lite-case-note__textarea"></textarea>
				<div class="lite-case-note__controls">
					<p id="input-case-note-warning" class="govuk-hint govuk-character-count__message" aria-live="polite">
						You can enter up to 2200 characters.
					</p>
					<div class="lite-case-note__controls-buttons">
						<a id="link-case-note-cancel" href="{{ post_url }}" class="govuk-link govuk-link--no-visited-state" type="button" draggable="false">{% lcs 'CANCEL' %}</a>
						<button id="button-case-note-post" class="govuk-button govuk-button--secondary govuk-button--secondary-white" type="submit">
							{% lcs 'POST_NOTE' %}
						</button>
					</div>
				</div>
			</div>
		{% endif %}
	</form>
{% endif %}

{% if notes %}
	<div class="lite-case-notes">
		{% for item in notes %}
			<p class="govuk-body">
				{% if item.user.team %}<span>{{ item.user.team.name }}</span>{% else %}<a href="{% url 'users:user' item.user.id %}" class="govuk-link govuk-link--no-visited-state govuk-!-font-weight-bold">{{ item.user.first_name }} {{ item.user.last_name }}</a>
				{% endif %} added a note:
			</p>
			<div class="lite-application-note lite-application-note{% if item.user.team %}--internal{% else %}--exporter{% endif %}">
				{{ item.text }}
			</div>
			<p class="govuk-hint govuk-!-font-size-16">{{ item.created_at|str_date }}</p>
			<br><br>
		{% endfor %}
	</div>
{% else %}
    <div class="lite-information-text">
        <span class="lite-information-text__icon" aria-hidden="true">!</span>
        <p class="lite-information-text__text">
            <span class="govuk-visually-hidden">Information</span>
            There are no notes on this application.
        </p>
    </div>
{% endif %}

<script src="{% static 'javascripts/helpers.js' %}"></script>
<script src="{% static 'javascripts/pluralize.js' %}"></script>
<script src="{% static 'javascripts/case-notes.js' %}"></script>
